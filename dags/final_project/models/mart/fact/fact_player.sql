{{ config(materialized='table') }}

SELECT
    sp.player_id,
    sp.player,
    sp.mp,
    sp.starts,
    sp.min,
    sp.ninety_s,
    sp.gls,
    sp.ast,
    sp.g_plus_a,
    sp.g_minus_pk,
    sp.pk,
    sp.pk_att,
    sp.crd_y,
    sp.crd_r,
    sp.xg,
    sp.npxg,
    sp.xag,
    sp.npxg_plus_xag,
    sp.g_plus_a_minus_pk,
    sp.xg_plus_xag,
    sp.prg_c,
    sp.prg_p,
    sp.prg_r,
    sp.sh,
    sp.sot,
    sp.sot_percent,
    sp.sh_per_90,
    sp.sot_per_90,
    sp.g_per_sh,
    sp.g_per_sot,
    sp.dist,
    sp.fk,
    sp.pk_stats_shooting,
    sp.pk_att_stats_shooting,
    sp.xg_stats_shooting,
    sp.npxg_stats_shooting,
    sp.npxg_per_sh,
    sp.g_minus_xg,
    sp.npxg_minus_xg,
    sp.cmp,
    sp.att,
    sp.cmp_percent,
    sp.tot_dist,
    sp.prg_dist,
    sp.ast_stats_passing,
    sp.xag_stats_passing,
    sp.xa,
    sp.a_minus_xag,
    sp.kp,
    sp.jan_3,
    sp.ppa,
    sp.crspa,
    sp.prgp_stats_passing,
    sp.live,
    sp.dead,
    sp.fk_stats_passing_types,
    sp.tb,
    sp.sw,
    sp.crs,
    sp.ti,
    sp.ck,
    sp.in_val,
    sp.out_val,
    sp.str,
    sp.cmp_stats_passing_types,
    sp.tkl,
    sp.tklw,
    sp.def_3rd,
    sp.mid_3rd,
    sp.att_3rd,
    sp.att_stats_defense,
    sp.tkl_percent,
    sp.lost,
    sp.blocks_stats_defense,
    sp.sh_stats_defense,
    sp.pass,
    sp.int_val,
    sp.tkl_plus_int,
    sp.clr,
    sp.err,
    sp.sca,
    sp.sca90,
    sp.pass_live,
    sp.pass_dead,
    sp.to_val,
    sp.sh_stats_gca,
    sp.fld,
    sp.def,
    sp.gca,
    sp.gca90,
    sp.touches,
    sp.def_pen,
    sp.def_3rd_stats_possession,
    sp.mid_3rd_stats_possession,
    sp.att_3rd_stats_possession,
    sp.att_pen,
    sp.live_stats_possession,
    sp.att_stats_possession,
    sp.succ,
    sp.succ_percent,
    sp.tkld,
    sp.tkld_percent,
    sp.carries,
    sp.tot_dist_stats_possession,
    sp.prg_dist_stats_possession,
    sp.prg_c_stats_possession,
    sp.one_third_stats_possession,
    sp.cpa,
    sp.mis,
    sp.dis,
    sp.rec,
    sp.prg_r_stats_possession,
    sp.crd_y_stats_misc,
    sp.crd_r_stats_misc,
    sp.two_crd_y,
    sp.fls,
    sp.fld_stats_misc,
    sp.off_stats_misc,
    sp.crs_stats_misc,
    sp.int_stats_misc,
    sp.tklw_stats_misc,
    sp.pkwon,
    sp.pkcon,
    sp.og,
    sp.recov,
    sp.won,
    sp.lost_stats_misc,
    sp.won_percent

FROM {{ref("stg_player")}} sp
LEFT JOIN {{ref("dim_player")}} dp
    ON sp.player_id = dp.player_id

LEFT JOIN {{ref("dim_club")}} d
    ON LOWER(TRIM(sp.club)) = LOWER(TRIM(d.club))