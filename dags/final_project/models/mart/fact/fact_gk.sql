{{ config(materialized='table') }}

SELECT
    g.gk_id,
    g.gk,
    g.nation,
    g.club,
    g.age,
    g.mp,
    g.starts,
    g.min,
    g.nineties,
    g.assists,
    g.goals_plus_assists,
    g.yellow_cards,
    g.red_cards,
    g.xg,
    g.npxg,
    g.xag,
    g.npxg_plus_xag,
    g.ga_minus_pk,
    g.xg_plus_xag,
    g.progressive_carries,
    g.progressive_passes,
    g.shots,
    g.shots_per_90,
    g.xg_stats_shooting,
    g.npxg_stats_shooting,
    g.g_minus_xg,
    g.npxg_minus_xg,
    g.passes_completed,
    g.passes_attempted,
    g.pass_completion_pct,
    g.total_distance,
    g.progressive_distance,
    g.assists_passing_stats,
    g.xag_stats_passing,
    g.xa,
    g.a_minus_xag,
    g.key_passes,
    g.final_third_passes,
    g.passes_into_penalty_area,
    g.progressive_passes_passing_stats,
    g.live_passes,
    g.dead_passes,
    g.free_kick_passes,
    g.through_balls,
    g.switches,
    g.completed_passes_passing_types,
    g.tackles,
    g.tackles_won,
    g.defensive_third_tackles,
    g.defensive_actions_attempted,
    g.lost_tackles,
    g.blocks,
    g.pass_blocks,
    g.interceptions,
    g.tackles_plus_interceptions,
    g.clearances,
    g.errors,
    g.shot_creating_actions,
    g.sca_per_90,
    g.shot_creating_live_passes,
    g.shot_creating_dead_passes,
    g.goal_creating_actions,
    g.gca_per_90,
    g.touches,
    g.defensive_penalty_area_touches,
    g.defensive_third_possession,
    g.midfield_third_possession,
    g.attacking_third_possession,
    g.attacking_penalty_area_touches,
    g.live_ball_possessions,
    g.attacking_touches_possession,
    g.dribbles_successful,
    g.dribbles_tackled,
    g.carries,
    g.carries_total_distance,
    g.carries_progressive_distance,
    g.progressive_carries_stats,
    g.carries_into_final_third,
    g.carries_into_penalty_area,
    g.miscontrols,
    g.dispossessed,
    g.receptions,
    g.yellow_cards_misc,
    g.red_cards_misc,
    g.fouls,
    g.fouled,
    g.interceptions_misc,
    g.tackles_won_misc,
    g.penalties_conceded,
    g.own_goals,
    g.recoveries,
    g.duels_won,
    g.duels_lost,
    g.duels_win_pct,
    g.goals_allowed,
    g.goals_allowed_per_90,
    g.shots_on_target_against,
    g.saves,
    g.save_pct,
    g.wins,
    g.draws,
    g.losses,
    g.clean_sheets,
    g.clean_sheet_pct,
    g.pk_attempts_faced,
    g.pk_allowed,
    g.pk_saved,
    g.post_shot_xg,
    g.psxg_per_shot_on_target,
    g.psxg_plus_minus,
    g.psxg_per_90,
    g.keeper_passes_completed,
    g.keeper_passes_attempted,
    g.keeper_pass_completion_pct,
    g.keeper_att,
    g.throws,
    g.launch_pct,
    g.average_pass_length,
    g.opponents_faced,
    g.keeper_stops,
    g.keeper_stop_pct,
    g.sweeper_actions,
    g.sweeper_actions_per_90,
    g.average_sweeper_distance
FROM {{ ref('stg_gk') }} g

LEFT JOIN {{ ref('dim_gk') }} dg
    ON g.gk_id = dg.gk_id

LEFT JOIN {{ ref('dim_club') }} d
    ON LOWER(TRIM(d.club)) = LOWER(TRIM(g.club))
